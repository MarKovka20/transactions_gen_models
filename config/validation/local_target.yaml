name: local_target

defaults:
  - val_mode: event_type

sequence_encoder:
  _target_: ptls.nn.RnnSeqEncoder
  trx_encoder:
    _target_: ptls.nn.TrxEncoder
    use_batch_norm_with_lens: True
    norm_embeddings: False
    embeddings_noise: 0.0003
    embeddings: {mcc_code: {in: 345, out: 24}}
    numeric_values: {amount: identity}
  hidden_size: 1024
  bidir: False
  trainable_starter: static
  type: lstm

path_to_state_dict: saved_models/coles_churn_yugay.pth

datamodule:
 _target_: ptls.frames.PtlsDataModule
 train_batch_size: 4
 valid_batch_size: 4
 test_batch_size: 4 
 train_num_workers: 2
 valid_num_workers: 2
 test_num_workers: 2

n_runs: 1

trainer:
  _target_: pytorch_lightning.Trainer
  accelerator: gpu
  devices: [0]
  max_epochs: 1500
  log_every_n_steps: 10
  logger: 
    _target_: pytorch_lightning.loggers.TensorBoardLogger
    save_dir: logs/local_validation/tensorboard
    # log_every_n_steps: 10
  